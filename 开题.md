# 课题来源、研究目的及意义

## 课题背景

### 无线自组织网络
&emsp;&emsp;无线自组织网络又称为ad hoc网络，是一种特殊的组网方式。相对于传统的无线蜂窝通信网络，ad hoc网络不需要固定的网络设备（如基站）的支持，即可完成节点之间的相互通信。Ad hoc 网络最重要的特征是所有网络节点相互等价，这里的等价既指硬件层面（如发射机、接收机以及天线的结构），又指软件层面（如协议栈）。节点的等价性使得Ad hoc 网络有着突出的优点，如在能源不足、自然环境恶劣、敌方破坏等情况下，网络中的某些节点无法正常工作，但网络中的其他节点仍然可以继续维持组网状态，不至于受到毁灭性的影响。此外，由于等价性，节点的入网也十分快速便捷。因此，ad hoc网络的建立具有很高的灵活性。

![ad hoc网络的拓扑变化](MANET.png){#fig:MANET}

&emsp;&emsp;此外，网络拓扑结构灵活多变是ad hoc网络的另一大特点。如[@fig:MANET]所示，网络中的节点可以自由地入网、脱网以及改变位置。这非常适合水面舰艇巡逻、飞机集群作战等应用场景。综上所述，ad hoc网络在一些特定场景下，如紧急救援、武器系统的协同作战等方面有着广泛的应用。

### 定向天线
&emsp;&emsp;定向天线的特点是其方向图中几乎只有一个主瓣，旁瓣分量很少，并且其主瓣宽度较窄。应用这样的天线，可以将能量集中在一个特定方向上进行发射。在相同的功率下，使用定向天线可以获得更大的通信距离。如[@fig:antenna]所示，目前定向天线的实现方式主要有两种，一类是基于波束切换，另一类是基于阵列合成。

![定向天线的类型](antenna.png){#fig:antenna}

&emsp;&emsp;在ad hoc网络中，定向天线比全向天线具有许多优势。首先，发射功率可以与波束宽度成比例地降低。在相同功率下，可提供更长的发送和接收距离。同时，传输和接收不同的波束会增加空间复用。此外，定向天线可有效减少不同节点之间的干扰。这些好处显着提高了ad hoc网络的容量和其他性能。

## 研究目的及意义
&emsp;&emsp;随着高新技术的发展和信息化水平的提高，单一的电子系统应用已经越来越满足不了人们的需求。系统之间的协同组网已经成为了发展趋势，如车联网使得自动驾驶成为可能，无人机集群大大提高了战斗能力。此外，现今无论是舰艇、飞机等武器系统，还是新兴的智能驾驶汽车等，均具有雷达等探测系统。本课题基于雷达等探测系统所形成的定向波束，来研究多节点协同组网的问题。在不影响其探测功能的条件下，给出通信探测一体化的解决方案。之后，根据仿真与实验，测试所设计的移动自组织网络(MANET)的性能。

# 国内外研究现状

&emsp;&emsp;基于定向波束的自组网因为具有独特的优势已经被人们广泛研究，研究的范围主要集中在MAC层算法和路由算法。此外，由于5G的兴起，相对于先前的通信体制有提出了许多新的概念。

## MAC层算法

&emsp;&emsp;MAC层即为媒介访问控制层，其研究重点是节点之间如何相互发现以及节点如何接入信道。Hongning Dai等人在2006年对基于定向天线的MAC层方案进行了总结性工作[@Dai2006An]，调查了使用定向天线的各种MAC协议，并根据天线类型、天线属性、节点移动性和性能问题等对它们进行了比较。文中指出MAC层算法可以分为两类，即随机竞争类和预分配类。这两类算法均有一些策略来避免冲突。Yihu Li等人在2006年提出了一种随机竞争类协议DMAC-DACA[@Li2006DMAC]。文章详细介绍了定向天线自组网中聋节点和隐藏终端等问题，并提出通过记录受干扰的邻居和干扰持续的时间，来避免冲突的算法。
Zhang Z.等人在2005年提出了一种时隙预分配类协议DTRA[@1453396]。DTRA协议分为三个功能阶段，分别是邻居发现阶段、时隙预约阶段和数据传输阶段。采用时分复用的方式，通过预先分配时隙，能够有效避免冲突的问题。此外，李洪生等人在2011年提出了对于DTRA协议的改进[@李洪生基于时隙调度的]。在时隙调度阶段，提出基于贪婪算法的边着色法，可以更好地保证时隙分配的公平有效。

&emsp;&emsp;Ram Ramanathan等人在2005年提出了一种用于邻居发现的扫描策略[@ramanathanAdHocNetworking2005]。该策略将网络中的节点随机分为发送和接收两种模式，发节点和收节点在相同时刻开始分别从正北和正南方向以相同的角速度$\omega$顺时针扫描，他们在一个扫描周期内必然会有扫描方向在一条直线上且相互对准，如[@fig:链路发现]所示。

![邻居发现策略](链路发现.png){#fig:链路发现}

&emsp;&emsp;该策略用于邻居发现效率很高，而且适用于时隙预分配类协议。

&emsp;&emsp;综上所述，采用时隙预分配类协议避免干扰冲突的方法比较简洁有效，而且有比较成熟的邻居发现策略。

## 路由算法

&emsp;&emsp;路由算法主要研究两个节点之间如何通过中继节点进行转发实现通信。Neelesh Gupta等人在2010年对于MANET网络种的路由协议进行了总结[@Gupta2010Routing]。按照每个节点存储的拓扑信息类型可以分为距离矢量路由协议和链路状态路由协议两大类；按路由发现策略可以分为表驱动路由协议和按需驱动路由协议两大类。两个分类方法完全独立，可以形成四种不同的路由协议类型。

&emsp;&emsp;Clausen等人在2003年提出了应用于MANET的路由协议OLSR[@clausenOptimizedLinkState2003]，OLSR协议是一种表驱动的基于链路状态的路由协议。OLSR中使用了MPR策略，有效地抑制冗余的信息洪泛。其转发表的计算基于Dijkstra算法，计算过程比较精简。C.E. Perkins等人在1999年提出了一种经典的按需驱动路由协议[@749281]，每当两个节点之间需要建立路由时，源节点就将路由请求信息进行广播，直到传送到目的节点，缓存每次转发的路径便可以获得路由信息。该协议无需进行周期性广播，协议开销较小，适合于节点间通信不频繁的场景。


## 协议栈结构

&emsp;&emsp;在3GPP最近发布的《5G NR》一书中，详细介绍了5G系统的协议栈结构[@sassanahmadi5GNR1st2019]。5G链路层设计的一大特点便是面向QoS，其分层设计、层间信息传递、与OSI模型的对应关系如[@fig:fig_arch]所示：

![5G链路层结构](fig_arch.svg){#fig:fig_arch}

上图中符号在[@tbl:5Glink]中说明

缩写|含义|释义
:-:|:--|:--
SDAP|service data adaptation protocol|服务数据适配协议:用于将IP流转换为QoS流
PDCP|packet data convergence protocol|分组数据汇聚协议:用于提供加密/压缩等功能
RLC|radio link control|无线链路控制:用于提供ARQ重传控制并划分逻辑信道
MAC|media access control|媒介访问控制:用于将逻辑信道的数据分组后在传输信道上传送

: 5G链路子层说明 {#tbl:5Glink}

# 研究内容

## MAC层的设计

&emsp;&emsp;由于本课题是基于窄带波束的研究，根据国内外研究现状一节阐述的内容，拟采用定向时分复用的技术。对于采用窄波束的定向天线的通信系统而言，节点的天线指向、收发模式、收发时隙共同确定了一条通信链路资源。主要研究的内容如下：

1. 在通信时长受约束的条件下（为保证探测等其他功能正常进行），设计TDMA的时帧结构，满足约束条件的同时做到节点快速入网、尽量减少端到端的延时。
2. 设计不同时隙下的具体功能，包括节点之间v握手包的格式、收发模式的转换以及本地维护的信息等
3. 考据节点入网、两网融合等问题。

&emsp;&emsp;MAC层需要结合物理层的具体特点进行设计，完成数据的有效传输。因此，MAC层的设计是本课题进一步研究的基础。

## 路由算法的设计

&emsp;&emsp;无线自组网的一大特点便是去中心化。由于没有基站等设备，节点之间的通信常常需要中间节点的中继。如何选择最佳的路由路径也是本课题研究的重点内容。主要包括以下几方面：

1. 考虑延时、链路质量等因素定义最佳路径的评价标准
2. 最佳路由的高效算法
3. 考虑负载均衡等问题

&emsp;&emsp;在自组网中，很多节点可能不直接相连。因此，高效的路由算法是保证节点间能否正常通信的关键。

## 面向QoS的链路层结构设计

&emsp;&emsp;在国内外研究现状一节已阐述过第五代移动通信技术面向QoS设计的特点，本课题拟参考5G体制链路层的结构特点，设计出保证简单QoS指标的链路层结构。主要包括以下几方面：

1. 根据5G提出的QoS数据流形式，将业务进行区分，划分出不同的优先级。根据优先级映射到不同的数据流中，以保证服务质量。
2. 根据5G无线链路控制的特点，设计透明传输、需确认信息传输、不需确认信息传输等不同的传输模式。
3. 根据5G分组汇聚协议，对于特殊业务可提供包头压缩。

&emsp;&emsp;QoS设计是在组网成功后的进一步优化，能够提供更高质量的服务。

# 研究方案与技术路线

## 参数约束

首先，根据实际的应用场景明确参数约束：

为了不影响探测等其他功能，对用于通信的时间进行约束：

* 组网建立时段,每100ms占用时间:20ms
* 网络维持阶段,每100ms占用时间:10ms

考虑到实际中相控阵雷达的发射波束，规定本课题中窄带波束的宽度：

* 发射波束宽度:$\Omega_{TX}=4.5°$
* 接收波束宽度:$\Omega_{RX}=4.5°$

## 技术方案的论证

### MAC层帧结构设计

#### 现有的方案

&emsp;&emsp;在[国内外研究现状]一节中讨论过，ad hoc网络的MAC层算法主要有两类，一种是随机竞争类算法，另一种是预分配类算法。随机竞争类算法会遇到“隐藏终端”和“聋节点”两类问题。尽管采用冲突避免算法可以解决部分问题，但是采用了全向天线，无法发挥定向网络的优势。而基于时分复用的预分配类算法，采用预先分配时隙的方式，可以完全避免冲突干扰等问题。因此，在本课题中拟采用预分配类算法。

&emsp;&emsp;MDTDMA协议是一种时隙预分配类MAC层协议。如[@fig:MDTDMA]所示其帧结构包含三个阶段，即邻居发现阶段（NB）、时隙预约阶段（R）以及数据传输阶段（D）。其特点是在两次邻居发现阶段间，重复多次时隙预约阶段和数据传输阶段，降低了上层数据包等待时隙分配的时间，提升了数据传输的效率。

![MDTDMA时帧结构](MDTDMA.png){#fig:MDTDMA}

&emsp;&emsp;虽然MDTDMA协议的数据传输效率较高，但是由于本课题中用于通信的时长受限（如1s内只有0.1s用于通信），因此按照此帧结构设计节点入网、脱网反应迟缓，不能适应快速的网络拓扑变化。

#### 拟采用的方案

&emsp;&emsp;因此，本课题拟将MDTDMA协议的时帧结构进行改进，来作为解决方案。依照设计目标，本节设计了一种D-TDMA时帧结构，该结构的主要特性如下:

1. 每个长帧为1000ms，由秒脉冲对齐。
2. 网络组建阶段中，每个长帧分为等长的20个短帧，每个短帧前10ms为通信时隙，后40ms为探测时隙。
3. 网络维持阶段中，每个长帧分为等长的10个短帧，每个短帧前10ms为通信时隙，后90ms为探测时隙。
4. 每个通信时隙由4个链路发现时隙和一个数据传时隙段组成。每隔一个链路发现时隙，天线转过一个波束宽度。
5. 每个数据传输时隙划分为20个通用时隙。
6. 在链路发现时隙中，互相发现的2个节点直接协商数据传输时隙的分配，以保证这两个节点能够在通用时隙组中分配到2个通用时隙，这2个时隙称为基本时隙。
7. 在基本时隙中，根据业务传输需求和信道资源利用率分配剩余通用时隙，被分配的时隙称为扩展时隙。

为了便于理解,在[@tbl:symbol]我们对时隙的符号做了规定：

|符号|含义|作用
|:-:|:--|:--
$C$|通信时隙|短帧中用于通信业务的时间段
$R$|探测时隙|短帧中用于雷达探测的时间段(本方案不与讨论)
$N$|链路发现时隙组|C时隙、S时隙中用于链路发现的时隙组,包含若干个链路发现时隙(Ni)
$D$|数据传输时隙组|C时隙中用于数据传输的时隙组,包含若干个数据传输时隙(Di)
: 时隙划分符号说明 {#tbl:symbol}

根据上述设计说明和符号定义,每个长帧的时隙划分情况如下图所示:

```
长帧时隙划分

网络组建阶段:
0      50    100    150    200    250    300    350    400    450    500(ms)
|+|++++|+|++++|+|++++|+|++++|+|++++|+|++++|+|++++|+|++++|+|++++|+|++++|
|C|  R |C|  R |C|  R |C|  R |C|  R |C|  R |C|  R |C|  R |C|  R |C|  R |
|+|++++|+|++++|+|++++|+|++++|+|++++|+|++++|+|++++|+|++++|+|++++|+|++++|

500   550    600    650    700    750    800    850    900    950   1000(ms)
|+|++++|+|++++|+|++++|+|++++|+|++++|+|++++|+|++++|+|++++|+|++++|+|++++|
|C|  R |C|  R |C|  R |C|  R |C|  R |C|  R |C|  R |C|  R |C|  R |C|  R |
|+|++++|+|++++|+|++++|+|++++|+|++++|+|++++|+|++++|+|++++|+|++++|+|++++|


网络维持阶段:
0            100           200           300           400          500(ms)
|+|+++++++++++|+|+++++++++++|+|+++++++++++|+|+++++++++++|+|+++++++++++|
|C|     R     |C|     R     |C|     R     |C|     R     |C|     R     |
|+|+++++++++++|+|+++++++++++|+|+++++++++++|+|+++++++++++|+|+++++++++++|

500          600           700           800           900         1000(ms)
|+|+++++++++++|+|+++++++++++|+|+++++++++++|+|+++++++++++|+|+++++++++++|
|C|     R     |C|     R     |C|     R     |C|     R     |C|     R     |
|+|+++++++++++|+|+++++++++++|+|+++++++++++|+|+++++++++++|+|+++++++++++|

```
```
通信时隙(C)划分
0   0.6  1.2  1.8  2.4 2.78  ~  9.62 10 (ms)     
|++++|++++|++++|++++|+++|+······+|+++|
| N1 | N2 | N3 | N4 |D1 | ······ |D20|
|++++|++++|++++|++++|+++|+······+|+++|
|<--------N-------->|<-······D·····->|
|<----------------C-···············->|
```

####  可行性分析

1. 定向链路发现时间
    * 网络组建阶段中每秒有20个短帧，每帧有4个链路发现时隙，共80个链路发现时隙,完成一次全扫描所用时间为1秒，即定向链路发现时间<1s.
    * 网络维持阶段中每秒有10个短帧，每帧有4个链路发现时隙，共40个链路发现时隙,完成一次全扫描所用时间为2s.定向链路发现时间为2s.

2. 传输延时
    * 基本时隙分配后,每对相邻节点在每2个短帧周期内有1次双向通信的机会.对于普通业务数据,可保证200ms/hop传输延时
    * 时敏业务情况下需首先调整数据时隙分配，为时敏业务分配扩展时隙,使得每1个短帧周期内节点有1次双向通信机会.该情况下,首个时敏业务包延时为200ms/hop，后续时敏业务包延时为100ms/hop.
  
### MAC层链路发现策略

#### 现有的方案

如下图所示，根据Ramanathan等的研究成果[@ramanathanAdHocNetworking2005]，相互对准的两个节点A和B，在相同时刻开始分别从正北和正南方向以相同的角速度$\omega$顺时针扫描，他们在一个扫描周期内必然有某一时刻$t_D$扫描方向在一条直线上且相互对准。

![天线扫描策略示意图](nd_scan.svg){#fig:nd_scan}

但是由于MAC层的时帧结构设计为两种，该方案并不能直接进行应用。

#### 拟采用的方案

本设计在此原理的基础上,结合D-TDMA时帧结构,设计可以兼容2种工作阶段的天线扫描策略。

对于波束宽度为$\Omega=4.5°$的天线,扫描总扇区数:

$$
  S=\frac{2\pi}{\Omega}=80
$$

根据[MAC层帧结构设计],每个C时隙中可以用于链路发现扫描的时隙数为$N_{CN}=4$.

在开始一次全扫描前,节点按$P=1/2$概率随机确定工作模式(广播模式或者侦听模式).两种模式在各个邻居发现时隙的收发方式见上图.

处于广播模式的节点称为广播节点,其全扫描从扇区1开始(即波束中心线方位角$\gamma=0°$),顺时针依次扫描各个扇区.

处于侦听模式的节点称为侦听节点,其全扫描从扇区41开始(即波束中心线方位角$\gamma=180°$),顺时针依次扫描各个扇区.

图X为两种扫描策略下节点在不同链路发现时隙的扫描扇区示意图.

```
N     1   2   3   4   ~   1'  2'  3'  4'  ~   5   6   7   8   ~   5'  6'  7'  8'

    |+++|+++|+++|+++|···|+++|+++|+++|+++|···|+++|+++|+++|+++|···|+++|+++|+++|+++|···
OA  | 1 | 2 | 3 | 4 |   | 41| 42| 43| 44|   | 5 | 6 | 7 | 8 |   | 45| 46| 47| 48|
    |+++|+++|+++|+++|···|+++|+++|+++|+++|···|+++|+++|+++|+++|···|+++|+++|+++|+++|···

    |+++|+++|+++|+++|···|+++++++++++++++|···|+++|+++|+++|+++|···|+++++++++++++++|···
IM  | 41| 42| 43| 44|   |       X       |   | 45| 46| 47| 48|   |       X       |
    |+++|+++|+++|+++|···|+++++++++++++++|···|+++|+++|+++|+++|···|+++++++++++++++|···

    |+++|+++|+++|+++|···|+++++++++++++++|···|+++|+++|+++|+++|···|+++++++++++++++|···
IA  | 1 | 2 | 3 | 4 |   |       X       |   | 5 | 6 | 7 | 8 |   |       X       |
    |+++|+++|+++|+++|···|+++++++++++++++|···|+++|+++|+++|+++|···|+++++++++++++++|···

    |+++|+++|+++|+++|···|+++|+++|+++|+++|···|+++|+++|+++|+++|···|+++|+++|+++|+++|···
OM  | 41| 42| 43| 44|   | 1 | 2 | 3 | 4 |   | 45| 46| 47| 48|   | 5 | 6 | 7 | 8 |
    |+++|+++|+++|+++|···|+++|+++|+++|+++|···|+++|+++|+++|+++|···|+++|+++|+++|+++|···

    |<----- C1----->|   |<-----C1'----->|   |<------C2----->|   |<-----C2'----->|

OA - 未入网广播节点(Offnet,Annoucing)
IM - 已入网侦听节点(Innet,Monitering)
IA - 已入网广播节点(Innet,Annoucing)
OM - 未入网侦听节点(Offnet,Monitering)
```

图中横坐标轴代表时间,以N时隙编号计量.表中的数字代表当前扫描的扇区.绝对值相差40的两个扇区方向相反.
可见在时间同步的前提下,无论节点当前是否已经入网,广播节点和侦听节点在一个扫描周期之中至少有一次天线相互对准的机会,因此本节所设计的两种天线扫描策略是可行并且相互兼容的.

#### 可行性分析

使用MATLAB对本节设计的链路发现策略进行仿真,主要仿真参数如下:

* 仿真网络:随机生成的48节点8跳网络如[@fig:nd_topo]所示
* 终止条件:由节点发现的网络拓扑与实际拓扑一致(拓扑收敛)
* 仿真场景:有外部时统,全部节点未入网,拓扑信息完全未知
* 试验次数:10000次

![网络拓扑](nd_topo.png){#fig:nd_topo}

拓扑收敛时间分布如[@fig:nd_dist]所示,其中拓扑收敛率为100%,最短收敛时间为5s,最长收敛时间为25s,平均收敛时间为8.84s.

![拓扑收敛时间分布](nd_dist.png){#fig:nd_dist}

&emsp;&emsp;根据本节设计,对于入网节点间的链路发现问题实质上与未入网节点间的链路发现问题等价,区别仅在于全扫描周期不同.故可认为本仿真结果同样适用于已入网节点之间的链路发现问题.      

&emsp;&emsp;因此根据仿真结果可以推算,对于已入网节点间的拓扑收敛时间介于10s至50秒之间.类似地,对于已入网节点和未入网节点之间的链路发现问题,由于两种节点具有相同的时帧结构,可以预计其拓扑收敛时间应介于上述两种仿真场景之间.

### 路由算法设计

#### 现有的方案

如国内外研究现状一节所述，MANET路由协议主要可以分为四类。表驱动类相较于按需驱动类协议，需要周期性维护路由信息，协议开销大但时效性好。链路状态类相较于距离矢量类，需要存储全网拓扑信息，优势为可加快路由收敛速度缺点是占用的存储资源较多。

#### 拟采用的方案

由于本课题研究的场景为通信与探测一体化组网，因此节点之间的通信频率不是很高，而且不是密集型网络节点数目较少。所以拟采用按需驱动基于链路状态的路由协议。

##### 链路状态信息的共享

&emsp;&emsp;当节点的时隙分配情况发生变化时，就需要向全网广播自己本地的时隙分配列表。在本方案中参考了OLSR协议进行路由广播的过程。OLSR协议使用了MPR机制抑制洪泛，这种机制的原理如[@fig:MPR]所示：    

![MPR机制](MPR.png){#fig:MPR}

&emsp;&emsp;在广播过程中，节点首先将信息广播给自己的所有邻居（称为1跳邻居），每个邻居收到信息后继续广播该信息，这样距离源节点2跳的节点（称为2跳邻居）也全都收到了信息。在左图中每个2跳邻居收到两次源节点信息，而在右图中通过选举MPR节点，就可抑制冗余的转发行为。

##### 广播数据包的格式

字段|位宽|意义
:-:|:-:|:-:
$RTYPE$|16|路由信息类型。 
$RID$|8|宣告邻居列表的节点$ID$
$RTTL$|8|路由生存时间。该字段的初始值为 15
$SEQ$|32|路由信息序列号。节点每发送一条路由信息，该计数器加一
$SLOT$|40|宣告的时隙分配列表

: 路由广播数据包的格式 {#tbl:data_type}

##### 本地信息的维护

在收到广播数据包时，每个节点都需要维护三个状态信息：  

* 全网拓扑表
* 转发表
* 已收数据包记录表

&emsp;&emsp;全网拓扑表采用矩阵结构存储，其中每一列代表一个节点的邻居列表，故全网拓扑表为$N×N$的布尔类型矩阵。 

&emsp;&emsp;转发表指示了从本地节点出发，是否能够抵达某一个节点；若能够抵达则还 将指示从本地节点开始，还将至少经过多少次发送才能到达目的节点（跳数），以及最短发送路径中的下一个节点（下一跳），转发表由全网拓扑表完全确定。

&emsp;&emsp;已收数据包记录表针对每一个节点记录如下信息：该节点宣告的时隙分配列表是否已经过期，来自该节点宣告信息的最新接收时间，以及来自该节点宣告信息的最新序列号。初始化时，所有节点对应的表项均处于过期状态。

具体的处理流程如[@fig:process]所示：

![路由处理过程](process.png){#fig:process}

路由表的计算采用Dijkstra算法。

#### 可行性分析

&emsp;&emsp;从理论分析上，本节拟采用的路由算法符合本课题的应用场景。更细致地分析，将在OPNET中进行仿真验证。

## 总体设计方案

### 网络结构

&emsp;&emsp;本课题预期的网络结构如[@fig:network]所示，终端数据发送时，接入节点完成以太网MAC协议和PCI-MANET协议的转换，并按照一定的路由规则将数据投递至目的节点；目的节点完成PCI-MANET协议与以太网MAC协议的转换，将数据送至目的终端所在的局域网交换设备(路由器、交换机)；局域网交换设备将数据投递至目的终端，完成数据传输过程。 本方案所设计的网络架构具备较强的可拓展性，可以与现有的以太网系统进行融合。

![网络架构](network.svg){#fig:network}


### 控制面数据传输

&emsp;&emsp;PCI-MANET中控制面数据流向如[@fig:relay_control]所示，源节点和目的节点的网络层及以上数据将从PDCP层进入协议栈进行处理；为了减小中继过程中的延时，数据流经过中继节点转发时，最高只能到达MAC层。

![控制面数据传输](relay_control.svg){#fig:relay_control}

### 用户面数据传输

&emsp;&emsp;PCI-MANET中用户面数据流向如[@fig:relay_user]所示，源节点和目的节点的网络层及以上数据将经过完整的协议栈处理；为了减小中继过程中的延时，数据流经过中继节点转发时，最高只能到达MAC层。

![用户面数据传输](relay.svg){#fig:relay_user}

### MAC层组网策略

进一步考虑节点无时间同步的情况，将组网的过程分为了以下几个阶段，如[@fig:stage]所示：

![阶段划分示意图](stage.svg){#fig:stage}

各阶段之间的关系和相互转化如[stage2.svg]所示.

![各阶段之间的相互转化](stage2.svg){#fig:stage2}

## 仿真与验证

* 首先对所有拟采用的方案在MATLAB中进行原理性验证，例如验证在拟采用的链路发现策略下能否获得全网拓扑、所采用的路由算法能否使全网连通等。
* 之后在OPNET仿真软件上进行更为细致的验证，包括握手包的格式、丢包率、端到端的延时、流量控制和拥塞控制等。
* 最终在FPGA上实现协议栈，通过模拟器进行实物仿真。

# 进度安排

|时间|研究任务|阶段成果|
:-:|:--|:--
2019.11.15-2019.12.15|与导师商讨并确定毕业设计题目，阅读文献进行课题调研|完成开题报告
2019.12.15-2020.1.15|进一步细化方案并在MATLAB中仿真，在OPNET中进行仿真模型构建（包括天线、节点模型等）|MATLAB仿真结果
2020.1.15-2020.2.15|在OPNET中完成MAC层的仿真并验证路由算法|OPNET初步仿真结果
2020.2.15-2020.3.1|在OPNET中进一步仿真QoS功能（包括紧急业务调度、重传控制等）|完整协议栈的仿真结果
2020.3.1-2020.4.15|在FPGA上进行协议栈的实现，并撰写论文框架|FPGA仿真
2020.4.15-2020.5.20|撰写毕业论文，结合模拟器进行实物测试|论文与实物测试结果

# 预期目标

为适应协同网络的复杂场景应用需求，所研协同网络应具备如下主要功能。

## 功能要求

1. 网络链路快速发现，节点入网响应延时短，编队网络自组织无中心建立，无中心化运维，支持子网络间的合并。
2. 能够同时支持外授时辅助及无外授时辅助的节点搜索与组网模式。
3. 网络能够自主根据链路传输负荷，动态均衡调整网络资源保障QoS。
4. 网络能够响应低延时数据传输请求，快速建立低延时数据通道。
5. 网络能够合成统一的节点拓扑图，并能够及时定期在全网共享信息。
6. 网络具备一定的抗攻击和抗干扰能力，具有网络身份验证、信息安全传输功能。
7. 网络具备强鲁棒性：在某节点发生故障或遭遇大流量网络数据时，能正常工作。
8. 多媒体及通用以太网支持特性：语音/视频、文电、IP数据包。
9. 具备物理层信道质量评估指示功能。

## 网络组织能力

1. 网络容量$N_{node}\ge48$
2. 支持跳数$N_{hop}\ge8$
3. 定向链路发现时间(借助外部时统):$T_{LD}\le1s$;
4. 网络组建时间:
   
   - 借助外部时统:$T_{NE}<60s$
   - 无外部时统:$T_{NE}<240s$

## 网络服务能力

1. 路由代价(窄带):$\eta_{rte}<5\%$
2. 端端延时(1-Hop):$\tau_{hop}\le100ms$(仅用于强实时优先级数据)
3. 传输延时:

    - 应用层->物理层发出:<50us
    - 物理层接收->应用层:<50us

4. 分组投递率:>90%
5. 广播更新周期:<2s
6. 重传控制:支持HARQ重传机制,重发次数$\le3$
7. 网络吞吐量:$\ge(N_{node}/4)BW$
8. 业务负荷过载能力:链路业务负载网络自主均衡,响应时间不大于1s
9. 网络流量统计上报周期:<5s

## 成果形式

1. 基于Opnet仿真，包含仿真场景、节点模型、链路模型、协议包模型等。 
2. 在FPGA开发板上实现，包含FPGA逻辑仿真结果与实际测试结果。

# 参考文献